name: ndk-test-arm64
on:
  push:
    branches:
      - main
jobs:
  ndk-build-arm64:
    name: Android NDK arm64-v8a Build Only
    runs-on: ubuntu-latest
    steps:
      - name: Install NDK
        run: |
          wget -q https://dl.google.com/android/repository/android-ndk-r26d-linux.zip
          unzip -q android-ndk-r26d-linux.zip
          echo "ANDROID_NDK_HOME=$(pwd)/android-ndk-r26d" >> $GITHUB_ENV

      - name: Build Hello World for arm64-v8a
        run: |
          cat > hello.c << 'EOF'
          #include <stdio.h>
          int main() {
              printf("Hello from Android arm64-v8a!\n");
              return 0;
          }
          EOF
          $ANDROID_NDK_HOME/toolchains/llvm/prebuilt/linux-x86_64/bin/aarch64-linux-android29-clang hello.c -o hello-arm64
          file hello-arm64
          echo "arm64-v8a binary built successfully"

      - name: Upload arm64 binary
        uses: actions/upload-artifact@v4
        with:
          name: hello-arm64-v8a
          path: hello-arm64
