name: sus cpp f hl

on:
  push:
    branches: main

jobs:
  test:
    runs-on: ubuntu-latest
    container: "opensuse/leap"
    steps:
      - name: install
        run: |
          zypper up -y
          zypper in -y \
              file gcc-c++ gcc-fortran git \
              make patch unzip which tree \
              cmake bison zlib-devel
      - name: test
        run: |
          git clone https://github.com/HDFGroup/hdf5
          cd hdf5
          mkdir build
          cd build
          cmake -DSITE:STRING="sus" \
          -DBUILDNAME:STRING="cpp/f/hl" \
          -DCTEST_DROP_SITE_INIT:STRING="my.cdash.org" \
          -DCTEST_DROP_LOCATION_INIT:STRING="/submit.php?project=HDF5" \
          -DHDF5_BUILD_FORTRAN=ON \
          -DHDF5_BUILD_HL_LIB=ON \
          -DHDF5_BUILD_CPP_LIB:BOOL=True \
          ..
          ctest  -C Release -D Experimental
